@model List<NoticeVM>;
<style type="text/css">
    .profile {
        float: right;
        padding: 10px;
        margin-top: 10px;
        margin-right: 30px;
    }
</style>
<div class="container" style="margin-top:20px">
    <div class="row">
        <div class="card">
            <div class="card-header">
                <b>নোটিশ যোগ করুন</b>
            </div>
            <div class="card-body">
                <div class="col-12">
                    <div class="row">
                        <div class="col-6">
                            <div class="form-group row mb-4">
                                <label class="col-sm-4 col-form-label-sm">বিষয়ঃ</label>
                                <div class="col-sm-8">
                                    <input type="text" id="name" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group row mb-4">
                                <label class="col-sm-4 col-form-label-sm">নোটিশের ছবিঃ</label>
                                <div class="col-sm-8">
                                    <input type="file" id="img">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12">
                    <button id="save" class="btn btn-success btn-sm profile">হালনাগাদ করুন</button>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header">
                <b>সকল নোটিশ</b>
            </div>
            <div class="card-body">
                <table class="table table-bordered table-striped">
                    <thead style="text-align:center">
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">নাম</th>
                            <th scope="col">নোটিশ</th>
                        </tr>
                    </thead>
                    <tbody style="text-align:center">
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td style="text-align: center;">@item.Id</td>
                                <td>@item.Name</td>
                                <td>@item.CreatedDate</td>
                                <td><a asp-area="DashBoard" asp-controller="Notice" asp-action="NoticeView" asp-route-id="@item.Id" target="_blank"><img src="/img/icon/pdf.png" width="40" height="40" /></a></td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
@section Scripts{
    <script>
        $(document).ready(function() {
        });
        $("#img").change(function(e) {
            for (var i = 0; i < e.originalEvent.srcElement.files.length; i++) {

                var file = e.originalEvent.srcElement.files[i];

                var img = document.createElement("img");
                var reader = new FileReader();
                reader.onloadend = function() {
                    img.src = reader.result;
                    img.width = 350;
                    img.height = 200;
                }
                reader.readAsDataURL(file);
                $("#img").after(img);
            }
        });
        $("#save").click(function() {
            var formData = new FormData();
            var totalFiles = document.getElementById("img").files.length;
            for (var i = 0; i < totalFiles; i++) {
                var file = document.getElementById("img").files[i];
                formData.append("ImgFiles", file);
            }
            formData.append("Name", $('#name').val());
            $.ajax({
                type: "POST",
                url: '/Admin/AdminPanel/SaveNotice',
                data: formData,
                dataType: 'json',
                contentType: false,
                processData: false,
                success: function(response) {
                    alertify.success("Successfully Added");
                    location.reload();
                }
            });
        });
    </script>
}